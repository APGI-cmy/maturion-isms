name: Copilot Setup Steps

# Runs during the "Prepare Copilot" phase â€” BEFORE "Start MCP Servers".
# Adds a preflight self-test for the agent-bootstrap MCP server so that
# missing dist/ files (MODULE_NOT_FOUND) surface as a clear Node stack trace
# rather than the generic "MCP error -32000: Connection closed".

on:
  workflow_dispatch: {}

jobs:
  copilot-setup-steps:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Agent-bootstrap MCP preflight self-test (Linux)
        shell: bash
        run: |
          set -euo pipefail
          echo "Node: $(node --version)"
          echo "PWD: $(pwd)"
          cd mcp-servers/agent-bootstrap
          echo "Running agent-bootstrap validation suite..."
          npm test
