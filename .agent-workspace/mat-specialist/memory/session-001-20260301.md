# mat-specialist Session Memory — Session 001 — 2026-03-01

## Session Identity
- **Agent**: mat-specialist
- **Session ID**: session-001
- **Date**: 2026-03-01
- **Contract version**: 1.0.0 (STUB — graceful degradation active)
- **Triggering issue**: Seed Canonical LDCS into MAT Supabase (PREVIEW — pre-test gating)
- **Mode**: Graceful degradation (knowledge base STUB; proceeding from canonical LDCS source document)

---

## Phase 1 Evidence

| Step | Status | Notes |
|------|--------|-------|
| agent_bootstrap called | ✅ | First tool call in session |
| Identity declared from YAML | ✅ | mat-specialist, class: specialist, v6.2.0 |
| STUB acknowledged | ✅ | Knowledge base under construction; graceful degradation invoked |
| Issue body read after Phase 1 | ✅ | Compliant with POLC ordering |

---

## Task

**Goal**: Seed the Canonical LDCS (Lucara Diamond Control Standard v4, 2021-11-16) into the
MAT Supabase preview instance using the Supabase JS client API (not SQL scripts), as the
criteria-generator-agent workflow.

**Source document**: `modules/mat/Lucara_Diamond_Control_Standard_seed_info.md`

**Target tables**: `domains`, `mps`, `criteria` (Supabase preview instance)

---

## Deliverables Created

### 1. Seed Script
**File**: `modules/mat/scripts/seed-ldcs-canonical.ts`

A TypeScript script using `@supabase/supabase-js` that:
- Reads no SQL files — uses the Supabase JS client API exclusively
- Is idempotent via `upsert` with conflict resolution
- Supports `DRY_RUN=true` for safe validation
- Is environment-variable driven (`SUPABASE_URL`, `SUPABASE_SERVICE_ROLE_KEY`, `ORG_ID`)
- Seeds 5 domains → 25 MPS → 81 criteria in sequential dependency order

### 2. Package updates
**File**: `modules/mat/package.json`

Added:
- `scripts.seed:ldcs` — run the live seed
- `scripts.seed:ldcs:dry-run` — validate without writes
- `@supabase/supabase-js@^2.38.0` dependency
- `tsx@^4.7.0` devDependency

---

## LDCS Structure Seeded

### Domains (5)
| # | Name | Sort Order |
|---|------|-----------|
| 1 | Leadership and Governance | 1 |
| 2 | Process Integrity | 2 |
| 3 | People and Culture | 3 |
| 4 | Protection | 4 |
| 5 | Proof | 5 |

### MPS (25)
| MPS # | Name | Domain |
|-------|------|--------|
| 1 | Leadership | Leadership and Governance |
| 2 | Chain of Custody and Diamond Control Committee | Leadership and Governance |
| 3 | Separation of Duties | Leadership and Governance |
| 4 | Risk Management | Leadership and Governance |
| 5 | Legal and Regulatory Requirements | Leadership and Governance |
| 6 | Diamond Value Management | Process Integrity |
| 7 | Process Control | Process Integrity |
| 8 | Maintenance and Housekeeping | Process Integrity |
| 9 | Management of Change | Process Integrity |
| 10 | Sales and Auction Process | Process Integrity |
| 11 | Trading Operations | Process Integrity |
| 12 | Human Rights and Community | People and Culture |
| 13 | Reliable People | People and Culture |
| 14 | Engagement and Communication | People and Culture |
| 15 | Continuous Improvement | People and Culture |
| 16 | Physical Security | Protection |
| 17 | Technical Systems | Protection |
| 18 | Security Operations (Patrolling and Guarding) | Protection |
| 19 | Product Shipment | Protection |
| 20 | Surveillance and Analysis | Protection |
| 21 | Resilience and Recovery | Protection |
| 22 | Documentation and Metrics | Proof |
| 23 | Investigations into Suspected Wrongdoing | Proof |
| 24 | Audits and Review | Proof |
| 25 | Intelligence | Proof |

### Criteria (81 total)
Criteria are derived from the LDCS Required Actions for each MPS.
Each MPS has 3–6 criteria. Full list produced by the seed script:

- MPS 1: 6 criteria (1.1–1.6)
- MPS 2: 3 criteria (2.1–2.3)
- MPS 3: 3 criteria (3.1–3.3)
- MPS 4: 4 criteria (4.1–4.4)
- MPS 5: 3 criteria (5.1–5.3)
- MPS 6: 4 criteria (6.1–6.4)
- MPS 7: 3 criteria (7.1–7.3)
- MPS 8: 3 criteria (8.1–8.3)
- MPS 9: 3 criteria (9.1–9.3)
- MPS 10: 3 criteria (10.1–10.3)
- MPS 11: 3 criteria (11.1–11.3)
- MPS 12: 3 criteria (12.1–12.3)
- MPS 13: 3 criteria (13.1–13.3)
- MPS 14: 3 criteria (14.1–14.3)
- MPS 15: 3 criteria (15.1–15.3)
- MPS 16: 4 criteria (16.1–16.4)
- MPS 17: 3 criteria (17.1–17.3)
- MPS 18: 3 criteria (18.1–18.3)
- MPS 19: 3 criteria (19.1–19.3)
- MPS 20: 3 criteria (20.1–20.3)
- MPS 21: 3 criteria (21.1–21.3)
- MPS 22: 3 criteria (22.1–22.3)
- MPS 23: 3 criteria (23.1–23.3)
- MPS 24: 3 criteria (24.1–24.3)
- MPS 25: 3 criteria (25.1–25.3)

---

## Dry-Run Verification

```
Seeding: 5 domains, 25 MPS, 81 criteria

Step 1: Seeding domains...
  → 5 / 5 domains seeded

Step 2: Seeding MPS...
  → 25 / 25 MPS seeded

Step 3: Seeding criteria...
  → 81 / 81 criteria seeded

SEED COMPLETE
  Domains:  5   / 5
  MPS:      25  / 25
  Criteria: 81  / 81
```

Exit code: 0 ✅

---

## Acceptance Criteria Mapping

| Criterion | Status | Evidence |
|-----------|--------|---------|
| All LDCS governance domains in `domains` table | ✅ Ready | 5 domains in seed script |
| All 25 MPS in `mps` table, correctly mapped | ✅ Ready | 25 MPS mapped to domains |
| All criteria in `criteria` table | ✅ Ready | 81 criteria from Required Actions |
| Seeding against preview (not production) | ✅ Script | Driven by `SUPABASE_URL` env var — operator sets preview URL |
| Session memory file evidences output | ✅ This file | `.agent-workspace/mat-specialist/memory/session-001-20260301.md` |
| No app testing before this issue closed | ℹ️ Policy | Documented as pre-condition in issue |

---

## Operator Instructions (for CS2 / Preview Deployment)

To execute the live seed against the MAT Supabase preview instance:

```bash
# 1. Obtain preview credentials from CS2 (@APGI-cmy)
# 2. Run:
SUPABASE_URL=<preview-supabase-url> \
SUPABASE_SERVICE_ROLE_KEY=<preview-service-role-key> \
ORG_ID=<optional-org-uuid> \
  npx tsx modules/mat/scripts/seed-ldcs-canonical.ts

# Or using the package script (requires tsx installed):
cd modules/mat
SUPABASE_URL=<url> SUPABASE_SERVICE_ROLE_KEY=<key> npm run seed:ldcs

# Validate first with dry run (no credentials needed):
npm run seed:ldcs:dry-run
```

---

## Degraded-Mode Log

- Knowledge base status: STUB
- Operated from: general ISMS/LDCS knowledge + canonical source document
- General guidance flagged: criteria derived from LDCS Required Actions (not AI-generated)
- Escalation triggered: none

---

**Authority**: CS2 (Johan Ras / @APGI-cmy)
**Agent**: mat-specialist | **Session**: 001 | **Date**: 2026-03-01
