# Integration Builder — Escalation

**Type**: BLOCKER  
**Date**: 2026-02-27  
**Session**: 002  
**Escalation Target**: Foreman

## Description

Git push to remote branch `copilot/hotfix-enable-production-deploy` is blocked by a Copilot SWE agent token scope limitation. The token (`ghu_ntIy...`) has **zero OAuth scopes** (`x-oauth-scopes:` header is empty when queried against GitHub API). The `repo` scope is required for git push. All write operations fail:

- `git push` → "Permission to APGI-cmy/maturion-isms.git denied to APGI-cmy" (HTTP 403)
- `gh api -X PATCH repos/.../git/refs` → "Resource not accessible by integration" (HTTP 403)
- `gh api -X PUT repos/.../contents/...` → "Resource not accessible by integration" (HTTP 403)

## Context
- Session: 002
- Task: Add branch guard to workflow_dispatch condition (security fix)
- Implementation: **COMPLETE** and verified locally
- Local commit SHA: `19d6fe1c5b8ebc0db0abd084796e07d71e4c2b49`
- Branch: `copilot/hotfix-enable-production-deploy`
- Remote branch current SHA: `d2b784a8857c66713e7c62185dc793fd44860635` (Initial plan)

## Commits Waiting to Push
1. `c28d72b` — fix: enable workflow_dispatch for deploy-production in deploy-mat-vercel.yml
2. `19d6fe1` — fix: restrict workflow_dispatch production deploy to main branch ← **this session's change**

## Recommendation
Foreman should:
1. Configure the Copilot SWE agent workflow with a token that has `repo` scope OR `contents: write` GitHub App permission
2. OR manually push the branch: the local working directory has the correct state at `19d6fe1`
3. The change can also be applied manually: in `.github/workflows/deploy-mat-vercel.yml` lines 194-196, replace `github.event_name == 'workflow_dispatch'` with `(github.event_name == 'workflow_dispatch' && github.ref == 'refs/heads/main')`
